/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * JFContasReceber.java
 *
 * Created on 20/03/2012, 21:23:18
 */
package br.classesprincipais;

import br.utilitario.Conexao;
import java.awt.Color;
import java.awt.Component;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JTable;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author Semp
 */
public class JFContasPagar extends javax.swing.JFrame {

    private Conexao con = new Conexao();
    private String codCompra,codFornecedor;
    //armazena o codigo da Compra selecionado na grid 1
    private String selecionado;
    private String codContasPagar;
    
    //verifica se a situaçao da conta a recer é aberto ou quitada
    private int situacao=1;
    
    public JFContasPagar() {
        initComponents();
        preenchejTable("'aberto'");
        setLocationRelativeTo(null);
        
        //tabela sem linhas
        DefaultTableModel modelo2 = (DefaultTableModel) jTable2.getModel();
        modelo2.setRowCount(0);

    }
    

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        bGFiltroSituacao = new javax.swing.ButtonGroup();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jTfornecedor = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jTtotal = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        jTDataCompra = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        jTcodCompra = new javax.swing.JTextField();
        jPanel2 = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTable2 = new javax.swing.JTable();
        jButton1 = new javax.swing.JButton();
        jPanel3 = new javax.swing.JPanel();
        jRadioButton1 = new javax.swing.JRadioButton();
        jRabertas = new javax.swing.JRadioButton();
        jRadioButton3 = new javax.swing.JRadioButton();
        jPanel5 = new javax.swing.JPanel();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jMenuBar1 = new javax.swing.JMenuBar();
        jMenu1 = new javax.swing.JMenu();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Contas a Pagar");
        addWindowFocusListener(new java.awt.event.WindowFocusListener() {
            public void windowGainedFocus(java.awt.event.WindowEvent evt) {
                formWindowGainedFocus(evt);
            }
            public void windowLostFocus(java.awt.event.WindowEvent evt) {
            }
        });
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowClosing(java.awt.event.WindowEvent evt) {
                formWindowClosing(evt);
            }
            public void windowOpened(java.awt.event.WindowEvent evt) {
                formWindowOpened(evt);
            }
        });

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "Código Compra", "Fornecedor", "Total da Compra", "Data da Compra", "Situação"
            }
        ));
        jTable1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTable1MouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(jTable1);

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder("Infromações Detalhadas"));

        jLabel1.setText("Fornecedor:");

        jLabel3.setText("Total da Venda:");

        jLabel4.setText("Data Compra:");

        jLabel5.setText("Código Compra:");

        jTcodCompra.setBackground(new java.awt.Color(102, 204, 255));

        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder("Parcelamento"));

        jTable2.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "Cod Parc", "Nº Parc", "Data Pagamento", "Valor", "Quitado"
            }
        ));
        jTable2.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTable2MouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(jTable2);

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 605, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(38, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 92, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel2, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel5)
                            .addComponent(jLabel1))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addComponent(jTcodCompra, javax.swing.GroupLayout.PREFERRED_SIZE, 66, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel4)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jTDataCompra, javax.swing.GroupLayout.PREFERRED_SIZE, 146, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel3)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jTtotal, javax.swing.GroupLayout.PREFERRED_SIZE, 87, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(jTfornecedor))
                        .addContainerGap())))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel5)
                    .addComponent(jTcodCompra, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel4)
                    .addComponent(jTDataCompra, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel3)
                    .addComponent(jTtotal, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(4, 4, 4)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(jTfornecedor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(12, 12, 12)
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jButton1.setText("Atualizar Informações");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder("Filtro"));

        bGFiltroSituacao.add(jRadioButton1);
        jRadioButton1.setText("Todas");
        jRadioButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jRadioButton1ActionPerformed(evt);
            }
        });

        bGFiltroSituacao.add(jRabertas);
        jRabertas.setSelected(true);
        jRabertas.setText("Abertas");
        jRabertas.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jRabertasActionPerformed(evt);
            }
        });

        bGFiltroSituacao.add(jRadioButton3);
        jRadioButton3.setText("Quitadas");
        jRadioButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jRadioButton3ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addComponent(jRadioButton3)
                .addGap(18, 18, 18)
                .addComponent(jRadioButton1)
                .addGap(35, 35, 35)
                .addComponent(jRabertas)
                .addContainerGap(72, Short.MAX_VALUE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(jRadioButton3)
                .addComponent(jRadioButton1)
                .addComponent(jRabertas))
        );

        jPanel5.setBackground(new java.awt.Color(51, 51, 51));
        jPanel5.setBorder(javax.swing.BorderFactory.createTitledBorder("Menu"));

        jButton2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/icones/Recycling_Bin.jpg"))); // NOI18N
        jButton2.setText("Excluir");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        jButton3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/icones/porta.gif"))); // NOI18N
        jButton3.setText("Sair");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jButton3, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jButton2, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 145, Short.MAX_VALUE))
                .addContainerGap(38, Short.MAX_VALUE))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGap(52, 52, 52)
                .addComponent(jButton2)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jButton3)
                .addContainerGap(390, Short.MAX_VALUE))
        );

        jMenu1.setText("Sistema");
        jMenuBar1.add(jMenu1);

        setJMenuBar(jMenuBar1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel1, 0, 625, Short.MAX_VALUE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jButton1)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 625, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jPanel5, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jButton1)
                            .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 254, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jTable1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTable1MouseClicked
        atualizaTables();
    }//GEN-LAST:event_jTable1MouseClicked

    private void jTable2MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTable2MouseClicked
       int pos  = jTable2.getSelectedRow();
       int col = jTable2.getSelectedColumn();
          
          
       
       JFAlteraParcela aux = new JFAlteraParcela(
             (String) jTable2.getValueAt(pos,0),
             (String) jTable2.getValueAt(pos,1),
             (String) jTable2.getValueAt(pos,2),
             (String) jTable2.getValueAt(pos,3),
             (String) jTable2.getValueAt(pos,4),
               "pagar");
      aux.setVisible(true);
       
       
      
       
      // Double valor = Double.parseDouble(JOptionPane.showInputDialog(null,"Informe o valor "));
       
  
       
    }//GEN-LAST:event_jTable2MouseClicked

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
       try
       {
           int quitada[] = new int[12];
           int cont=0;
           boolean confirma=false;
           con.conecta();
           con.executaSql("select quitada from parcelas "+ 
                        " inner join contas_pagar  on (contas_pagar.codContas_pagar = parcelas.cod_contas_pagar)"+ 
                        " inner join Compra on (compra.codCompra = contas_pagar.compra_codCompra)"+
                        " where contas_pagar.compra_codCompra =  "+selecionado);
           while(con.getRs().next())
           {
               if(con.getRs().getString("quitada").equalsIgnoreCase("N"))
               {
                   quitada[cont]=2;
               }else 
               {
                   quitada[cont]=1;
               }
               cont++;
           }
           
           for(int i=0;i<=cont;i++)
           {
               if(quitada[i]==2)
               {
                   confirma=false;
                   break;
               }else
               {
                   confirma=true;
               }
           }
           
           if(confirma==true)
           {
               
               con.conecta();
               con.executaSql("update contas_pagar set situacao='quitada' where compra_codCompra = "+selecionado);
               con.getPs().execute();
               
               situacao=1;
               preenchejTable("'aberto'");
               //JOptionPane.showMessageDialog(null,"QUITADA");
                       
           }else
           {
             //JOptionPane.showMessageDialog(null,"nao QUITADA");
           }
           
           con.getCon().close();
           
       }catch(Exception e)
       {
           JOptionPane.showMessageDialog(null, e);
       }
    }//GEN-LAST:event_jButton1ActionPerformed

    private void formWindowOpened(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowOpened
       situacao =2;
    }//GEN-LAST:event_formWindowOpened

    private void jRabertasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jRabertasActionPerformed
        preenchejTable("'aberto'");
    }//GEN-LAST:event_jRabertasActionPerformed

    private void jRadioButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jRadioButton3ActionPerformed
        preenchejTable("'quitada'");
    }//GEN-LAST:event_jRadioButton3ActionPerformed

    private void jRadioButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jRadioButton1ActionPerformed
       // situacao =1;
        preenchejTable(" 'aberto' or situacao = 'quitada' ");
    }//GEN-LAST:event_jRadioButton1ActionPerformed

    private void formWindowGainedFocus(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowGainedFocus
          atualizaTables();
          atualizaSituacao();
    }//GEN-LAST:event_formWindowGainedFocus

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        try
        {
            con.conecta();
            int i = JOptionPane.showConfirmDialog(null, "Deseja excluir ?");

            if(i==0)
            {
                
                con.executaSql("delete from parcelas where cod_contas_pagar = "+codContasPagar);
                con.getPs().execute();
                
                con.executaSql("delete from contas_pagar where compra_codCompra = "+selecionado);
                con.getPs().execute();
                
                
                
                JOptionPane.showMessageDialog(null, "Excluido com sucesso");
            }
            
           con.getCon().close();
            
        }catch(Exception e)
        {
            JOptionPane.showMessageDialog(null, e);
        }
    }//GEN-LAST:event_jButton2ActionPerformed

    private void formWindowClosing(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowClosing
         con.fechaConexao();
    }//GEN-LAST:event_formWindowClosing

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
        dispose();
    }//GEN-LAST:event_jButton3ActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                new JFContasPagar().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.ButtonGroup bGFiltroSituacao;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JMenu jMenu1;
    private javax.swing.JMenuBar jMenuBar1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JRadioButton jRabertas;
    private javax.swing.JRadioButton jRadioButton1;
    private javax.swing.JRadioButton jRadioButton3;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JTextField jTDataCompra;
    private javax.swing.JTable jTable1;
    private javax.swing.JTable jTable2;
    private javax.swing.JTextField jTcodCompra;
    private javax.swing.JTextField jTfornecedor;
    private javax.swing.JTextField jTtotal;
    // End of variables declaration//GEN-END:variables

    public void atualizaTables()
    {
         try
        {

            /*con.conecta();
            con.executeStatement("select * from venda "
                    + " inner join contas_receber  on(contas_receber.venda_codVenda = venda.codVenda)  "
                    + " inner join cliente  on (cliente.codCliente = venda.cliente_CodCliente)"
                    + "");*/
            DefaultTableModel modelo = (DefaultTableModel) jTable1.getModel();
            selecionado =  String.valueOf(jTable1.getValueAt(jTable1.getSelectedRow(), 0));
            jTcodCompra.setText(selecionado);
            jTfornecedor.setText(String.valueOf(jTable1.getValueAt(jTable1.getSelectedRow(),1)));
            jTtotal.setText(String.valueOf(jTable1.getValueAt(jTable1.getSelectedRow(),2)));
            jTDataCompra.setText(String.valueOf(jTable1.getValueAt(jTable1.getSelectedRow(),3)));
            String situacao = String.valueOf(jTable1.getValueAt(jTable1.getSelectedRow(),4));

            con.conecta();
            con.executaSql("select p.num_parcelas,codContas_pagar  from parcelas_cp p "
                    + " inner join contas_pagar cr on (p.cod_contas_pagar = cr.codContas_pagar)"
                    + " where cr.compra_codCompra = "+selecionado);
            con.getRs().next();
            int numParcelas  =Integer.parseInt(con.getRs().getString("num_parcelas"));
            codContasPagar = con.getRs().getString("codContas_pagar");
            con.getRs().first();
            
                                
            DefaultTableModel modelo2 = (DefaultTableModel) jTable2.getModel();
            modelo2.setRowCount(0);
           
            
            con.executaSql("select *  from parcelas_cp p "
                    + " inner join contas_pagar cr on (p.cod_contas_pagar = cr.codContas_pagar)"
                    + " where cr.compra_codCompra = "+selecionado);

            while(con.getRs().next())
            {
                jTable2.setDefaultRenderer(Object.class, new DefaultTableCellRenderer()
                  {  
                    @Override
                        public Component getTableCellRendererComponent(JTable table, Object value,  
                        boolean isSelected, boolean hasFocus, int row, int column)
                        {  
                            super.getTableCellRendererComponent(table, value, isSelected,  
                                hasFocus, row, column); 
                           
                            if (row%2==0) {  
                                setBackground(Color.CYAN); 
                                
                            }else if (row%2 == 1) {  
                                setBackground(null); 
                            }
                             
                             return this;  
                        }  
                    });  
                
                modelo2.addRow(new Object[]{con.getRs().getString("codParcela"),numParcelas+"/"+con.getRs().getString("num_parcelas"),
                    con.getRs().getString("data_pagamento"),con.getRs().getString("valor_parcela"),con.getRs().getString("quitada")
                });
                
                numParcelas --;
                
            }
           
           // con.getCon().close();
        }catch(Exception e)
        {
            //JOptionPane.showMessageDialog(null, e);
        }
    }
    
    
    public void preenchejTable(String estado)
    {
        try
        {
            con.conecta();
            String sql="";
            DefaultTableModel modelo = (DefaultTableModel) jTable1.getModel();
            modelo.setRowCount(0);


           sql = "select * from compra "
                + " inner join contas_pagar  on(contas_pagar.compra_codCompra = compra.codCompra)  "
                + " inner join fornecedor  on (fornecedor.codFornecedor = compra.fornecedor_CodFornecedor)"
                + " where situacao = "+estado+" order by compra.codCompra desc "; 

            
            con.executeStatement(sql);

            while(con.getRs().next())
            {
                jTable1.setDefaultRenderer(Object.class, new DefaultTableCellRenderer()
                  {  
                    @Override
                        public Component getTableCellRendererComponent(JTable table, Object value,  
                        boolean isSelected, boolean hasFocus, int row, int column)
                        {  
                            super.getTableCellRendererComponent(table, value, isSelected,  
                                hasFocus, row, column); 
                           
                            if (row%2==0) {  
                                setBackground(Color.CYAN); 
                                
                            }else if (row%2 == 1) {  
                                setBackground(null); 
                            }
                             
                             return this;  
                        }  
                    });
                
                modelo.addRow(new Object[]{con.getRs().getString("codCompra"),con.getRs().getString("nome_fornecedor"),
                    con.getRs().getString("valor_total"),con.getRs().getString("data_compra"),con.getRs().getString("situacao")
                });


            }
           con.getRs().first();
           // con.getCon().close();
         

        }catch(Exception e)
        {
           javax.swing.JOptionPane.showMessageDialog(null, e);
        }
        
    }
    
    public void atualizaSituacao()
    {
     try
       {
           int quitada[] = new int[12];
           int cont=0;
           boolean confirma=false;
           con.conecta();
           con.executaSql("select quitada from parcelas_cp "+ 
                        " inner join contas_pagar  on (contas_pagar.codContas_pagar = parcelas_cp.cod_contas_pagar)"+ 
                        " inner join compra on (compra.codCompra = contas_pagar.compra_codCompra)"+
                        " where contas_pagar.compra_codCompra =  "+selecionado);
           while(con.getRs().next())
           {
               if(con.getRs().getString("quitada").equalsIgnoreCase("N"))
               {
                   quitada[cont]=2;
               }else 
               {
                   quitada[cont]=1;
               }
               cont++;
           }
           
           for(int i=0;i<=cont;i++)
           {
               if(quitada[i]==2)
               {
                   confirma=false;
                   break;
               }else
               {
                   confirma=true;
               }
           }
           
           if(confirma==true)
           {
               
               con.conecta();
               con.executaSql("update contas_pagar set situacao='quitada' where compra_codCompra = "+selecionado);
               con.getPs().execute();
               
               situacao=1;
               preenchejTable(" 'aberto' ");
               //JOptionPane.showMessageDialog(null,"QUITADA");
                       
           }else
           {
             //JOptionPane.showMessageDialog(null,"nao QUITADA");
           }
           
           con.getCon().close();
           
       }catch(Exception e)
       {
           JOptionPane.showMessageDialog(null, e);
       }
    }
}
